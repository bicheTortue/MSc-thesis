\section{\acs{C. elegans} dataset}
\label{sec:resCelegans}

\subsubsection{Network configuration}

The layers used to solve this problem are listed below :

\begin{itemize}
  \item An \ac{LSTM} with eight hidden states and an input with feature size of four (because of the four input neurons that are considered), one thousand time steps and every time steps outputs a value for the next layer.
  \item A time distributed dense layer with an output size of four. It is time distributed because it needs to compute every time steps and not only the last.
\end{itemize}

The \ac{LSTM} was chosen with a number of hidden states of eight because it gets the best results \cite{celegans}.

\Cref{fig:celegansModel} is a graphical representation of the model just described.

\begin{figure}[H]
  \centering
  \includesvg[width=\textwidth]{datasets/celegansModel}
  \caption{Model used to solve the \ac{C. elegans} problem}
  \label{fig:celegansModel}
\end{figure}

Due do the complexity of this dataset and the results associated are only trained using the analog activation function. Furthermore, the usefulness of using those activation functions was already demonstrated in \cref{sec:resAirline}.

The results will be analyzed by focusing on a single data sequence, the training data sequence available in \cref{graph:io5Celegans}.

\subsection{Digital results}
\label{subsec:digitalCelegans}

\subsection{Analog results}
\label{subsec:analogCelegans}

It's been established in \cref{sec:resAirline}, that the analog circuit with a serial size of one ($n_s=1$) show a lower \ac{RMSE} to the digital predictions than the digital predictions.

Due to the complexity of the dataset, the simulation were only ran using a serial size of one ($n_s=1$) to get the best looking results.

This part will show the result of the inference when the weights were trained using the analog activation functions.

\begin{figure}[H]
  \centering
  \includesvg[width=\linewidth]{results/celegans/out5}
  \caption{\acs{C. elegans} analog responses with their digital counterparts}
  \label{graph:celegansAnalog0}
\end{figure}

\Cref{graph:celegansAnalog0} contains the predictions of both the digital and analog \ac{NN} for all four output neurons that are being monitored. The having all predicted responses to the stimuli on the same graph makes things very unintelligeable.

The response have thus been sperated into four graphs. One for every neuron for better readability. The target response was also added to all four graphs to highlight the objective of the \ac{NN}. Those graphs can be found in \cref{graph:spread5Celegans}.

A big problem that is immediatly visible is that the LUAL output neuron's analogly predicted response is negative when it should not be. For an unknown reason the analog results of the LUAL neuron seem to be negative instead of positive. This is the case for the analog response to all sequences. This issue most likely comes from dense layer that comes after the \ac{LSTM}. In order to keep using the data the output of this neuron will be flipped over the x-axis.


\begin{figure}[H]
  \centering
  \begin{minipage}{\columnwidth}
    \subfloat[Analog prediction for the DB1 neuron\label{graph:out5BD1Celegans}]{\includesvg[width=0.5\textwidth, pretex=\tiny]{results/celegans/out5DB1}}%
    \hfill
    \subfloat[Analog prediction for the LUAL neuron\label{graph:out5LUALCelegans}]{\includesvg[width=0.5\textwidth,pretex=\tiny]{results/celegans/out5LUAL}}%
  \end{minipage}
  \begin{minipage}{\columnwidth}
    \subfloat[Analog prediction for the PVR neuron\label{graph:out5PVRCelegans}]{\includesvg[width=0.5\textwidth, pretex=\tiny]{results/celegans/out5PVR}}%
    \hfill
    \subfloat[Analog prediction for the VB1 neuron\label{graph:out5VB1Celegans}]{\includesvg[width=0.5\textwidth,pretex=\tiny]{results/celegans/out5VB1}}%
  \end{minipage}
  \caption{\ac{C. elegans} analog responses with their digital counterparts spread out for each output neuron}
  \label{graph:spread5Celegans}
\end{figure}

All the analog predicted responses seem to have the same problem. When the response is flat, the signal looks very good, while with a small vertical displacement. That displacement could be attributed to the difference of computations from the digital training to the analog inference (\cref{sec:resAirline}). However, when the analog response sends out a pulse, the said pulse is very unstable. It continuously flickers up and down. This can be observed by zooming on the graph like in \cref{graph:zoom5Celegans}.

This phenomenen is very strange and hasn't been identified so far. The main theory is that the data isn't stored properly in the memory cells, thus at every \ac{LSTM} time step the supposed output is slightly altered. This would create this flickering of the outputed data.

The data isn't useless for that matter. It was decided to smooth the data by averaging every output point with its neighboring points. This simple average will smooth out the curves to get a decently readable result, that can then be compared with the digitally predicted response. The python code for this function is available at \cref{}. %TODO

\begin{figure}[H]
  \centering
  \includesvg[width=\linewidth]{results/celegans/zoom5}
  \caption{\acs{C. elegans} DB1 analog response with zoom on the pulses}
  \label{graph:zoom5Celegans}
\end{figure}

The smoothed out and exploitable analog predictions are available in \cref{graph:smooth5Celegans}. Theses graphs allow for a much easier visualisation of the results.

The best looking output of the four predicted neurons responses is the one from PVR. That is confirmed by its error rate to the digital prediction. It is the lowest of the four, however, it isn't close enough to the digital prediction.

All four analog predictions are very close to each others

\begin{figure}[H]
  \centering
  \begin{minipage}{\columnwidth}
    \subfloat[Averaged analog prediction for the DB1 neuron\label{graph:smooth5BD1Celegans}]{\includesvg[width=0.5\textwidth, pretex=\tiny]{results/celegans/smooth5DB1}}%
    \hfill
    \subfloat[Averaged analog prediction for the LUAL neuron\label{graph:smooth5LUALCelegans}]{\includesvg[width=0.5\textwidth,pretex=\tiny]{results/celegans/smooth5LUAL}}%
  \end{minipage}
  \begin{minipage}{\columnwidth}
    \subfloat[Averaged analog prediction for the PVR neuron\label{graph:smooth5PVRCelegans}]{\includesvg[width=0.5\textwidth, pretex=\tiny]{results/celegans/smooth5PVR}}%
    \hfill
    \subfloat[Averaged analog prediction for the VB1 neuron\label{graph:smooth5VB1Celegans}]{\includesvg[width=0.5\textwidth,pretex=\tiny]{results/celegans/smooth5VB1}}%
  \end{minipage}
  \caption{\ac{C. elegans} smoothed out analog responses averaged with $21$ neighbors, spread out for each output neuron}
  \label{graph:smooth5Celegans}
\end{figure}
